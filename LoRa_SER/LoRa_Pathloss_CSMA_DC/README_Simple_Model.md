# LoRa シンプルモデル

## 概要
このモデルは、LoRa通信の基本的な要素を含むシンプルなシミュレーションモデルです。複雑な要素を排除し、以下の基本機能に焦点を当てています：

- **固定SF値**: 全端末が同じSF（Spreading Factor）を使用
- **CSMA/CA**: キャリアセンス多重アクセス/衝突回避
- **DC制約**: デューティサイクル制約
- **ポアソン点過程**: 端末のランダム配置
- **パスロス**: 距離に基づく伝搬損失

## 主な特徴

### 1. シンプルな設計
- SF値は固定（デフォルト: SF7）
- シャドウイングなし
- 複雑なSNR計算なし

### 2. 端末配置
- ポアソン点過程に基づくランダム配置
- 円形エリア内（デフォルト: 半径0.5km）
- ゲートウェイは原点（0,0）に配置

### 3. 通信プロトコル
- **CSMA/CA**: チャネルがビジーの場合はバックオフ
- **DC制約**: 送信時間に基づく待機時間
- **PER計算**: パケットエラー率の計算

### 4. 伝搬モデル
- パスロスモデル: `PL = 10α*log10(d) + β + 10γ*log10(fc)`
- パラメータ:
  - α = 4.0 (パスロス係数)
  - β = 9.5 (伝搬損失オフセット)
  - γ = 4.5 (伝搬周波数係数)
  - fc = 923.2 MHz (搬送波周波数)

## パラメータ設定

```julia
# 基本パラメータ
const area_size = 0.5        # エリアサイズ(km)
const SF = 7                 # 固定SF値
const Tx_dB = 13.0           # 送信電力(dBm)
const f_c = 923.2            # 搬送波周波数(MHz)

# パスロス係数
const α = 4.0
const β = 9.5
const γ = 4.5

# 通信パラメータ
const band_width = 125e3     # 帯域幅(Hz)
const SNR_threshold = -7.5   # SNR閾値(dB)
```

## 使用方法

### 基本的な実行
```julia
julia LoRa_Simple_Model.jl
```

### カスタムパラメータでの実行
```julia
# シミュレーション実行
per, positions, snrs, errors = simple_csma_dc_per(
    sf=7,                    # SF値
    bw=125e3,               # 帯域幅
    num_devices=50,         # 端末数
    payload_range=(16,32),  # ペイロード長範囲
    sim_time=1.0,           # シミュレーション時間
    backoff_max=0.01,       # 最大バックオフ時間
    dc=0.01                 # デューティサイクル
)
```

## 出力結果

### 1. シミュレーション結果
- 総端末数
- エラー数
- PER（パケットエラー率）
- 平均距離
- 平均SNR
- SNR範囲

### 2. 可視化
- 端末配置プロット（エラー状態で色分け）
- ゲートウェイ位置の表示
- PNG形式で保存

### 3. 統計分析
- 複数回実行による統計
- 平均PER、標準偏差
- 最小・最大PER

## ファイル構成

```
LoRa_Simple_Model.jl          # メインシミュレーションファイル
README_Simple_Model.md        # このファイル
simple_model_plot.png         # 生成されるプロットファイル
```

## 元の複雑モデルとの違い

| 要素 | 複雑モデル | シンプルモデル |
|------|------------|----------------|
| SF選択 | 動的（距離・SNRベース） | 固定 |
| シャドウイング | あり | なし |
| 端末配置 | ランダム | ポアソン点過程 |
| SNR計算 | 複雑 | シンプル |
| 分析機能 | 詳細 | 基本 |

## 今後の拡張可能性

1. **SF適応**: 距離に基づくSF選択の追加
2. **シャドウイング**: ログ正規シャドウイングの追加
3. **干渉モデル**: より詳細な干渉計算
4. **移動性**: 端末の移動モデル
5. **エネルギー消費**: バッテリー消費モデル

## 注意事項

- このモデルは教育・研究目的で作成されています
- 実際のLoRaデバイスの動作とは異なる場合があります
- パラメータは調整可能ですが、現実的な値の範囲内で設定してください
